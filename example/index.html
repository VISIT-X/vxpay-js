<!DOCTYPE html>
<html>
<head>
	<title>VXPay - sample integration</title>
	<link rel="stylesheet" href="./../node_modules/material-components-web/dist/material-components-web.css">
	<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
</head>
<body class="mdc-typography">
	<div class="mdc-layout-grid">
		<div class="mdc-layout-grid__inner">
			<div class="mdc-layout-grid__cell--span-12">
				<h4 class="mdc-typography--title">Open</h4>
				<div class="mdc-layout-grid__inner">
					<label for="use-tab" class="mdc-layout-grid__cell--span-12">
						<input type="checkbox" name="use-tab" id="use-tab" onchange="onToggleTab(document.getElementById('use-tab').checked)" />
						Open in a new tab
					</label>
					<a class="mdc-button mdc-button--raised mdc-layout-grid__cell--span-3" href="#" id="open-login">Login</a>
					<a class="mdc-button mdc-button--raised mdc-layout-grid__cell--span-3" href="#" id="open-signup">Register</a>
					<a class="mdc-button mdc-button--raised mdc-layout-grid__cell--span-3" href="#" id="open-login-or-signup">Login or Register</a>
					<a class="mdc-button mdc-button--raised mdc-layout-grid__cell--span-3" href="#" id="reset-password">Reset password</a>
					<a class="mdc-button mdc-button--raised mdc-layout-grid__cell--span-3" href="#" id="lost-password">Lost password</a>
					<a class="mdc-button mdc-button--raised mdc-layout-grid__cell--span-3" href="javascript:vxpay.openPayment()">General Payment</a>
					<a class="mdc-button mdc-button--raised mdc-layout-grid__cell--span-3" href="#" id="open-voice-call">Voice call</a>
					<a class="mdc-button mdc-button--raised mdc-layout-grid__cell--span-3" href="javascript:vxpay.limitPayment()">Limited payment</a>
					<a class="mdc-button mdc-button--raised mdc-layout-grid__cell--span-3" href="javascript:vxpay.changeCard()">Change card</a>
					<a class="mdc-button mdc-button--raised mdc-layout-grid__cell--span-3" href="javascript:vxpay.openAbo()">VIP abo</a>
					<a class="mdc-button mdc-button--raised mdc-layout-grid__cell--span-3" href="javascript:vxpay.vipAboTrial()">VIP trial abo</a>
					<a class="mdc-button mdc-button--raised mdc-layout-grid__cell--span-3" href="javascript:vxpay.premiumAbo()">Premium abo</a>
					<a class="mdc-button mdc-button--raised mdc-layout-grid__cell--span-3" href="javascript:vxpay.openSettings()">Extended settings</a>
					<a class="mdc-button mdc-button--raised mdc-layout-grid__cell--span-3" href="javascript:vxpay.openAVS()">Age verification</a>
					<a class="mdc-button mdc-button--raised mdc-layout-grid__cell--span-3" href="javascript:vxpay.openPromoCode()">Promo code</a>
					<a class="mdc-button mdc-button--raised mdc-layout-grid__cell--span-3" href="javascript:vxpay.openScratchCard()">Scratch card</a>
					<a class="mdc-button mdc-button--raised mdc-layout-grid__cell--span-3" href="javascript:vxpay.openOneClick()">One click</a>
					<a class="mdc-button mdc-button--raised mdc-layout-grid__cell--span-3" href="javascript:vxpay.openAutoReCharge()">Auto recharge</a>
					<a class="mdc-button mdc-button--raised mdc-layout-grid__cell--span-3" href="javascript:vxpay.openBalance()">Open balance</a>
				</div>
			</div>
			<div class="mdc-layout-grid__cell--span-12">
				<h4 class="mdc-typography--title">Actions</h4>
				<div class="mdc-layout-grid__inner">
					<a class="mdc-button mdc-button--raised mdc-layout-grid__cell--span-3" href="javascript:isLoggedInAction()">Is logged in?</a>
					<a class="mdc-button mdc-button--raised mdc-layout-grid__cell--span-3" href="javascript:logout()">Logout</a>
					<a class="mdc-button mdc-button--raised mdc-layout-grid__cell--span-3" href="javascript:getAvsStatus()">AVS status</a>
					<a class="mdc-button mdc-button--raised mdc-layout-grid__cell--span-3" href="javascript:getBalance()">Get balance</a>
					<a class="mdc-button mdc-button--raised mdc-layout-grid__cell--span-3" href="javascript:getAbos()">Get active abos</a>
				</div>
			</div>
		</div>
	</div>

	<!-- Load the library -->
	<script type="text/javascript">
		var vxpay, config;

		/**
		 * Re-init as tab
		 * @param {Boolean} enable
		 */
		onToggleTab = function(enable) {
			config = new VX.VXPayConfig(window);
			config.enableTab = enable;
			config.logging = true;
			vxpay = new VX.VXPay(config);
		};

		__init = function() {
			config = new VX.VXPayConfig(window);
			config.logging = true;
			config.language = VX.VXPayLanguage.EN;
			vxpay = new VX.VXPay(config);
		};

		document.addEventListener('DOMContentLoaded', function() {
			/** Open login click handler */
			document.getElementById('open-login').onclick = function(e) {
				e.preventDefault();
				vxpay.openLogin().then(function() { console.log('Login opened') });
			};

			/** Open registration */
			document.getElementById('open-signup').onclick = function(e) {
				e.preventDefault();
				vxpay.openSignUp().then(function() { console.log('SignUp opened') });
			};

			/** Open registration or login */
			document.getElementById('open-login-or-signup').onclick = function(e) {
				e.preventDefault();
				vxpay.openSignUpOrLogin().then(function() { console.log('Opened') });
			};

			/** Password reset */
			document.getElementById('reset-password').onclick = function(e) {
				e.preventDefault();
				vxpay.resetPassword().then(function() { console.log('Opened password reset') });
			};

			/** Password lost */
			document.getElementById('lost-password').onclick = function(e) {
				e.preventDefault();
				vxpay.lostPassword().then(function() { console.log('Opened password lost') });
			};

			document.getElementById('open-voice-call').onclick = function(e) {
				e.preventDefault();
				vxpay.openVoiceCall().then(function() { console.log('Open voice call') });
			}
		});

		isLoggedInAction = function() {
			vxpay.isLoggedIn()
				.then(function(msg) {
					confirm('Logged in: ' + (msg.loggedIn === true ? 'YES' : 'NO'))
				})
		};

		getAvsStatus = function() {
			vxpay.getAVSStatus()
				.then(function(msg) {
					confirm('AVS status: ' + (msg.status.fsk18 === true ? 'FSK18' : '<unknown>'))
				})
		};

		getBalance = function() {
			vxpay.getBalance()
				.then(function(msg) {
					confirm('Current balance: ' + msg.balance.toString())
				});
		};

		getAbos = function() {
			vxpay.getActiveAbos()
				.then(function(msg) {
					var abos = '';

					msg.abos.forEach(function(abo) {
						abos += abo.name + ' (' + abo.amount + '), ';
					});

					confirm('Active abos: ' + abos)
				});
		};

		logout = function() {
			vxpay.logout().then(function(msg) {
				alert('User logged out');
			});
		}
	</script>
	<script type="text/javascript" src="./../build/vxpay.min.js" onload="__init()"></script>
</body>
</html>